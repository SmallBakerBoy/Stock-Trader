{% extends 'base.html' %}

{% block title %} Home {% endblock %}

{% block body %} 
<h1>Overview</h1>
<table><tr>
    <td><div class="container" style="width: 300px; height: 300px;">
        <h1>Assets</h1>
    </div></td>
    <td><div class="container" style="width: 300px; height: 300px;">
        <h1>Watchlist</h1>
    </div></td>
    <td><div class="container" style="width: 300px; height: 300px;">
        <h1>Accounts</h1>
    </div></td>
    </tr></table>

    

    {% if assets %}
        <h1>Suggested Trades</h1>
            <table><tr>
            <td><div class="container" style="height: 300px; background-color: #dbedd3;">
                <h1>Buy Suggestions</h1>
                <ul>
                {% for trade in trades %}
                    {% if trade.type == 1 %}
                    <li>{{trade.ticker}} - {{trade.amount}}</li>
                    {% endif %}
                {% endfor %}
                </ul>
            </div></td>
            <td><div class="container" style="height: 300px; background-color: #f4cdcc;">
                <h1>Sell Suggestions</h1>
                <ul>
                {% for trade in trades %}
                    {% if trade.type == 0 %}
                    <li>{{trade.ticker}} - {{trade.amount}}</li>
                    {% endif %}
                {% endfor %}
                </ul>
            </div></td>
        </tr></table>
        <form method='POST'>
            {% csrf_token %}
            {{ form.as_p }}
            <button type="button" class="submit" onclick='update_portfolio()'>Update Portfolio</button>
            </form>
    {% else %}
        <div class='container'>
            <p> You do not have any registered assets.</p>
            <form method='POST'>
            {% csrf_token %}
            {{ form.as_p }}
            {% csrf_token %}
            <button type="button" class="submit" onclick='create_portfolio()'>Create Portfolio</button>
            </form>
        </div>
    {% endif %}

<script>
    const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]').value;

    function create_portfolio() {
        var settings = {}
        fetch('/home/create',
            {method: 'POST',
             headers: {'Content-type':'application/json','X-CSRFToken': csrftoken},
             body: JSON.stringify(settings)
        }
        )
    }

    function update_portfolio() {
        var settings = {}
        fetch('/home/create',
            {method: 'POST',
             headers: {'Content-type':'application/json','X-CSRFToken': csrftoken},
             body: JSON.stringify(settings)
        }
        )
    }
</script>

{% endblock %}

